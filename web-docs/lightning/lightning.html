<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Lightning Exercises</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Lightning Exercises</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._prog-prob%29" class="tocviewlink" data-pltdoc="x">Programming Problems</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._rev-prob%29" class="tocviewlink" data-pltdoc="x">Review Problems</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Submission_.Guidelines%29" class="tocviewlink" data-pltdoc="x">Submission Guidelines</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Lightning_.Exercises%29" class="tocsubseclink" data-pltdoc="x">Lightning Exercises</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._prog-prob%29" class="tocsubseclink" data-pltdoc="x">Programming Problems</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Palindrome_.Detection_.Modulo_.Spaces_and_.Capitalization%29" class="tocsubseclink" data-pltdoc="x">Palindrome Detection Modulo Spaces and Capitalization</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Sum_.Over_.Table%29" class="tocsubseclink" data-pltdoc="x">Sum Over Table</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._.Adding_.Machine%29" class="tocsubseclink" data-pltdoc="x">Adding Machine</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._rev-prob%29" class="tocsubseclink" data-pltdoc="x">Review Problems</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Rainfall%29" class="tocsubseclink" data-pltdoc="x">Rainfall</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Length_of_.Triples%29" class="tocsubseclink" data-pltdoc="x">Length of Triples</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Shopping_.Discount%29" class="tocsubseclink" data-pltdoc="x">Shopping Discount</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Submission_.Guidelines%29" class="tocsubseclink" data-pltdoc="x">Submission Guidelines</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._.Lightning_.Exercises)"></a>Lightning Exercises</h2><p>This homework will not incorporate peer review. You are expected to do
the work entirely on your own (without help from the course staff,
whom you may only consult for help with names of library functions or
other essential information of that sort).</p><p><span class="refelem"><span class="refcolumn"><span class="refcontent">Note that some of the problems use special values like
<span class="stt">0</span> or <span class="stt">-999</span> to delimit content. In general, you
should not do this in your own programs: use properly structured data
rather than embedding the shape <span style="font-style: italic">in</span> the data. However, sometimes
you will confront real-world data sources that do this, and you may
not have the freedom to change them. These problems give you a feel for
working in such settings.</span></span></span>
There are two sets of three problems each. The first set
[<a href="#%28part._prog-prob%29" data-pltdoc="x">Programming Problems</a>] requires you to write fresh programs. The
second set [<a href="#%28part._rev-prob%29" data-pltdoc="x">Review Problems</a>] gives you solutions to problems and
asks you to identify which ones you prefer and why.</p><h3>1<tt>&nbsp;</tt><a name="(part._prog-prob)"></a>Programming Problems</h3><h4>1.1<tt>&nbsp;</tt><a name="(part._.Palindrome_.Detection_.Modulo_.Spaces_and_.Capitalization)"></a>Palindrome Detection Modulo Spaces and Capitalization</h4><p>A palindrome is a string with the same letters in each of forward and
reverse order (ignoring capitalization).  Design a program called
<span class="stt">is-palindrome</span> that consumes a string and produces a boolean
indicating whether the string with all spaces and punctuation removed
is a palindrome.  Treat all non-alphanumeric characters (i.e., ones
that are not digits or letters) as punctuation.</p><p><div class="SIntrapara">Examples:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">is-palindrome("a man, a plan, a canal: Panama") is true</span></p></td></tr><tr><td><p><span class="stt">is-palindrome("abca") is false</span></p></td></tr><tr><td><p><span class="stt">is-palindrome("yes, he did it") is false</span></p></td></tr></table></blockquote></div></p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Sum_.Over_.Table)"></a>Sum Over Table</h4><p>Assume that we represent tables of numbers as lists of rows, where
each row is itself a list of numbers. The rows may have different
lengths.  Design a program <span class="stt">sum-largest</span> that consumes a table of
numbers and produces the sum of the largest item from each row. Assume
that no row is empty.</p><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">sum-largest(</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[list: [list: 1, 7, 5, 3], [list: 20], [list: 6, 9]])</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">is (7 + 20 + 9)</span></p></td></tr></table></blockquote></div></p><h4>1.3<tt>&nbsp;</tt><a name="(part._.Adding_.Machine)"></a>Adding Machine</h4><p>Design a program called <span class="stt">adding-machine</span> that consumes a list of
numbers and produces a list of the sums of each non-empty sublist
separated by zeros.  Ignore input elements that occur after the first
occurrence of two consecutive zeros.</p><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">adding-machine([list: 1, 2, 0, 7, 0, 5, 4, 1, 0, 0, 6])</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">is [list: 3, 7, 10]</span></p></td></tr></table></blockquote></div></p><h3>2<tt>&nbsp;</tt><a name="(part._rev-prob)"></a>Review Problems</h3><p>Below you are given problem statements followed by multiple solutions
to each problem. Assume that the solutions are correct; ignore any
small deviations in behavior. Also assume that any missing helper
functions are defined in the obvious way. Finally, ignore stylistic
differences in naming. Instead, focus on the structure of the
solutions.</p><p>Use
<a href="http://goo.gl/forms/pN4ReZHYVA">this form</a>
(logged in with your Brown Google ID) to provide your answers. For
each problem, rank the solutions in order (from most to least) of your
preference. You are allowed to have ties. Below the ranking grid,
explain why you picked that ordering, mentioning briefly all solutions
in your response.</p><p>The solutions are labeled A, B, etc. Indicate your ordering by
selecting the appropriate radio button for each solution. For
instance, selecting &ldquo;1st&rdquo; for B, &ldquo;2nd&rdquo; for A and C, and &ldquo;3rd&rdquo;
for D means you liked B the <span style="font-style: italic">most</span>, followed by A and C (tied),
followed by D.</p><p>Remember to explain your choice!</p><h4>2.1<tt>&nbsp;</tt><a name="(part._.Rainfall)"></a>Rainfall</h4><p>Design a program called <span class="stt">rainfall</span> that consumes a list of real
numbers representing daily rainfall readings.  The list may contain
the number <span class="stt">-999</span> indicating the end of the data of interest.
Produce the average of the non-negative values in the list up to the
first <span class="stt">-999</span> (if it shows up).  There may be negative numbers
other than <span class="stt">-999</span> in the list (representing faulty readings).
Assume that there is at least one non-negative number before
<span class="stt">-999</span>.</p><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">rainfall([list: 1, -2, 5, -999, 8]) is 3</span></p></td></tr></table></blockquote></div></p><p>Solution <span style="font-weight: bold">A</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun rainfall(l :: List&lt;Number&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun helper(rds :: List&lt;Number&gt;, total :: Number, days :: Number) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cases (List) rds:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| empty =&gt; total / days</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| link(f, r) =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f == -999 then: total / days</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f &lt; 0 then: helper(r, total, days)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise: helper(r, total + f, days + 1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">helper(l, 0, 0)</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><p>Solution <span style="font-weight: bold">B</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun rainfall(l :: List&lt;Number&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun sum-rfs(shadow l :: List&lt;Number&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cases (List) l:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| empty =&gt; 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| link(f, r) =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f == -999 then: 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f &lt; 0 then: sum-rfs(r)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise: f + sum-rfs(r)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun count-days(shadow l :: List&lt;Number&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cases (List) l:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| empty =&gt; 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| link(f, r) =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f == -999 then: 0</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f &lt; 0 then: count-days(r)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise: 1 + count-days(r)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">total = sum-rfs(l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">days = count-days(l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">total / days</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><p>Solution <span style="font-weight: bold">C</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun rainfall(l :: List&lt;Number&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun cleanse(shadow l :: List&lt;Number&gt;) -&gt; List&lt;Number&gt;:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cases (List) l:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| empty =&gt; empty</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| link(f, r) =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f == -999 then: empty</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f &lt; 0 then: cleanse(r)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">link(f, cleanse(r))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">actual = cleanse(l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">total = sum-of(actual)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">days = actual.length()</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">total / days</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><h4>2.2<tt>&nbsp;</tt><a name="(part._.Length_of_.Triples)"></a>Length of Triples</h4><p><div class="SIntrapara">Design a program called <span class="stt">max-triple-length</span> that consumes a list
of strings and produces the length of the longest concatenation of
three consecutive elements.  Assume the input contains at least three
strings. Also assume we are given
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">data Triple: triple(a, b, c) end</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">max-triple-length([list: "a", "bb", "c", "dd"]) is 5</span></p></td></tr></table></blockquote></div></p><p>Solution <span style="font-weight: bold">A</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun max-triple-length(l :: List&lt;String&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun break-into-triples(shadow l :: List&lt;String&gt;) -&gt; List&lt;Triple&gt;:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">link(triple(l.first, l.rest.first, l.rest.rest.first),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| is-empty(l.rest.rest.rest) then: empty</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise: break-into-triples(l.rest)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">triple-lengths = map(lam(t): string-length(t.a) + string-length(t.b) + string-length(t.c) end,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">break-into-triples(l))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">max-of(triple-lengths)</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><p>Solution <span style="font-weight: bold">B</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun max-triple-length(l :: List&lt;String&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun break-into-triples(shadow l :: List&lt;Number&gt;) -&gt; List&lt;Triple&gt;:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">link(triple(l.first, l.rest.first, l.rest.rest.first),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| is-empty(l.rest.rest.rest) then: empty</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise: break-into-triples(l.rest)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">triples-as-nums = map(string-length, l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">triple-lengths = map(lam(t): t.a + t.b + t.c end,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">break-into-triples(triples-as-nums))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">max-of(triple-lengths)</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><p>Solution <span style="font-weight: bold">C</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun max-triple-length(l :: List&lt;String&gt;) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">shadow l = map(string-length, l)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun helper(shadow l :: List&lt;Number&gt;, max-so-far :: Number, prev-2 :: Number, prev-1 :: Number) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cases (List) l:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| empty =&gt; max-so-far</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| link(f, r) =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">prev-3 = prev-2 + f</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">helper(r,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if prev-3 &gt; max-so-far: prev-3 else: max-so-far end,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">prev-1 + f,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">f)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">helper(l.rest.rest.rest,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">l.first + l.rest.first + l.rest.rest.first,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">l.rest.first + l.rest.rest.first,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">l.rest.rest.first)</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><h4>2.3<tt>&nbsp;</tt><a name="(part._.Shopping_.Discount)"></a>Shopping Discount</h4><p><div class="SIntrapara">An online clothing store applies discounts during checkout.  A
shopping cart is a list of the items being purchased.  Each item has a
name (a string like &#8220;shoes&#8221;) and a price (a real number like
12.50).  Design a program called <span class="stt">checkout</span> that consumes a
shopping cart and produces the total cost of the cart after applying
the following two discounts:
</div><div class="SIntrapara"><ul><li><p>if the cart contains at least 100 worth of shoes, take 20% off
the cost of all shoes (match only items whose exact name is
<span class="stt">"shoes"</span>)</p></li><li><p>if the cart contains at least two hats, take 10 off the total of
the cart (match only items whose exact name is <span class="stt">"hat"</span>)</p></li></ul></div><div class="SIntrapara">Assume the cart is represented as follows:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">data CartItem: ci(name :: String, cost :: Number) end</span></p></td></tr><tr><td><p><span class="stt">type Cart = List&lt;CartItem&gt;</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">checkout(</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[list: ci("shoes", 25), ci("bag", 50),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ci("shoes", 85),</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">ci("hat", 15)])</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">is 153</span></p></td></tr></table></blockquote></div></p><p>Solution <span style="font-weight: bold">A</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun checkout(cart :: Cart) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">shoes = filter(lam(c): c.name == "shoes" end, cart)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">shoe-cost = sum-of(map(lam(c): c.cost end, shoes))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">shoe-discount = if shoe-cost &gt;= 100: shoe-cost * 0.20 else: 0 end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">hats = filter(lam(c): c.name == "hat" end, cart)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">hat-count = hats.length()</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">hat-discount = if hat-count &gt;= 2: 10 else: 0 end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">init-cost = sum-of(map(lam(c): c.cost end, cart))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">init-cost - shoe-discount - hat-discount</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><p>Solution <span style="font-weight: bold">B</span>:</p><blockquote><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">fun checkout(cart :: Cart) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fun helper(ct :: Cart, total :: Number, shoe-cost :: Number, hat-count :: Number) -&gt; Number:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">cases (List) ct:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| empty =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">shoe-discount = if shoe-cost &gt;= 100: shoe-cost * 0.20 else: 0 end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">hat-discount = if hat-count &gt;= 2: 10 else: 0 end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">total - shoe-discount - hat-discount</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| link(f, r) =&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">new-total = total + f.cost</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">ask:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f.name == "shoes" then:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">helper(r, new-total, shoe-cost + f.cost, hat-count)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| f.name == "hat" then:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">helper(r, new-total, shoe-cost, hat-count + 1)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| otherwise:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">helper(r, new-total, shoe-cost, hat-count)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">end</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">helper(cart, 0, 0, 0)</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></blockquote><h3>3<tt>&nbsp;</tt><a name="(part._.Submission_.Guidelines)"></a>Submission Guidelines</h3><p>For the programming tasks, please create three files in
<a href="https://code.pyret.org/">code.pyret.org</a>, one per problem.
Name them <span class="stt">palindrome.arr</span>, <span class="stt">sum.arr</span>, and
<span class="stt">adding.arr</span>. After you finish writing your programs, download your
solutions to your computer.  Create a zip file of these and upload
using Captain Teach. For the ranking tasks, respond using the linked
Web form.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>